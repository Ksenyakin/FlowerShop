{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UpdateUserPage=()=>{const[formData,setFormData]=useState({name:'',phone:'',address:'',birthday:''});const[message,setMessage]=useState('');const[error,setError]=useState('');useEffect(()=>{// Загрузка текущих данных пользователя при загрузке страницы\nconst fetchUserData=async()=>{try{const response=await fetch('/api/userinfo',{method:'GET',headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`,'Content-Type':'application/json'}});if(!response.ok){throw new Error('Failed to fetch user data');}const data=await response.json();setFormData({name:data.name||'',phone:data.phone||'',address:data.address||'',birthday:data.birthday||''});}catch(err){setError('Не удалось загрузить данные пользователя');}};fetchUserData();},[]);const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));};const handleSubmit=async e=>{e.preventDefault();setMessage('');setError('');try{const response=await fetch('/api/update_user',{method:'POST',headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`,'Content-Type':'application/json'},body:JSON.stringify(formData)});if(!response.ok){throw new Error('Failed to update user');}setMessage('Данные успешно обновлены!');}catch(err){setError('Ошибка при обновлении данных');}window.location.href='/profile';};return/*#__PURE__*/_jsxs(\"div\",{className:\"update-user-page\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"success-message\",children:message}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"update-user-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"\\u0418\\u043C\\u044F:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",name:\"name\",value:formData.name,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"phone\",children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"phone\",name:\"phone\",value:formData.phone,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"address\",children:\"\\u0410\\u0434\\u0440\\u0435\\u0441:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"address\",name:\"address\",value:formData.address,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"birthday\",children:\"\\u0414\\u0435\\u043D\\u044C \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"birthday\",name:\"birthday\",value:formData.birthday,onChange:handleChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C \\u0438\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u044F\"})]})]});};export default UpdateUserPage;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","UpdateUserPage","formData","setFormData","name","phone","address","birthday","message","setMessage","error","setError","fetchUserData","response","fetch","method","headers","localStorage","getItem","ok","Error","data","json","err","handleChange","e","value","target","prev","handleSubmit","preventDefault","body","JSON","stringify","window","location","href","className","children","onSubmit","htmlFor","type","id","onChange"],"sources":["C:/Users/DanKs/GolandProjects/flower-shop-backend/frontend/src/components/UpdateUserPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nconst UpdateUserPage: React.FC = () => {\r\n    const [formData, setFormData] = useState({\r\n        name: '',\r\n        phone: '',\r\n        address: '',\r\n        birthday: '',\r\n    });\r\n    const [message, setMessage] = useState('');\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        // Загрузка текущих данных пользователя при загрузке страницы\r\n        const fetchUserData = async () => {\r\n            try {\r\n                const response = await fetch('/api/userinfo', {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to fetch user data');\r\n                }\r\n\r\n                const data = await response.json();\r\n                setFormData({\r\n                    name: data.name || '',\r\n                    phone: data.phone || '',\r\n                    address: data.address || '',\r\n                    birthday: data.birthday || '',\r\n                });\r\n            } catch (err) {\r\n                setError('Не удалось загрузить данные пользователя');\r\n            }\r\n        };\r\n\r\n        fetchUserData();\r\n    }, []);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = e.target;\r\n        setFormData((prev) => ({\r\n            ...prev,\r\n            [name]: value,\r\n        }));\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        setMessage('');\r\n        setError('');\r\n\r\n        try {\r\n            const response = await fetch('/api/update_user', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify(formData),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Failed to update user');\r\n            }\r\n\r\n            setMessage('Данные успешно обновлены!');\r\n        } catch (err) {\r\n            setError('Ошибка при обновлении данных');\r\n        }\r\n        window.location.href = '/profile'\r\n    };\r\n\r\n    return (\r\n        <div className=\"update-user-page\">\r\n            <h1>Изменение данных пользователя</h1>\r\n\r\n            {message && <p className=\"success-message\">{message}</p>}\r\n            {error && <p className=\"error-message\">{error}</p>}\r\n\r\n            <form onSubmit={handleSubmit} className=\"update-user-form\">\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"name\">Имя:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"name\"\r\n                        name=\"name\"\r\n                        value={formData.name}\r\n                        onChange={handleChange}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"phone\">Телефон:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"phone\"\r\n                        name=\"phone\"\r\n                        value={formData.phone}\r\n                        onChange={handleChange}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"address\">Адрес:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"address\"\r\n                        name=\"address\"\r\n                        value={formData.address}\r\n                        onChange={handleChange}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"birthday\">День рождения:</label>\r\n                    <input\r\n                        type=\"date\"\r\n                        id=\"birthday\"\r\n                        name=\"birthday\"\r\n                        value={formData.birthday}\r\n                        onChange={handleChange}\r\n                    />\r\n                </div>\r\n\r\n                <button type=\"submit\" className=\"button\">Сохранить изменения</button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default UpdateUserPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}