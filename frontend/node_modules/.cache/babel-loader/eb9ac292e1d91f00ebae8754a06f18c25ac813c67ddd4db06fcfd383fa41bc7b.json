{"ast":null,"code":"import React,{useEffect,useState}from'react';import'./UserDropdown.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserDropdown=()=>{const[userInfo,setUserInfo]=useState(null);const[isOpen,setIsOpen]=useState(false);useEffect(()=>{const fetchUserInfo=async()=>{try{const response=await fetch('/api/userinfo',{method:'GET',headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`,'Content-Type':'application/json'}});if(!response.ok){throw new Error('Ошибка при получении информации о пользователе');}const data=await response.json();setUserInfo(data);}catch(error){console.error('Ошибка:',error);}};fetchUserInfo();},[]);const handleLogout=()=>{localStorage.removeItem('token');window.location.href='/';};return/*#__PURE__*/_jsxs(\"div\",{className:\"user-dropdown\",onMouseEnter:()=>setIsOpen(true),onMouseLeave:()=>setIsOpen(false),children:[/*#__PURE__*/_jsx(\"span\",{className:\"username\",children:userInfo?userInfo.name:'Загрузка...'}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-menu\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/profile\",children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/orders\",children:\"\\u0417\\u0430\\u043A\\u0430\\u0437\\u044B\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/favorites\",children:\"\\u0418\\u0437\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435\"}),(userInfo===null||userInfo===void 0?void 0:userInfo.role)===\"admin\"&&/*#__PURE__*/_jsx(\"a\",{href:\"/admin\",children:\"\\u0410\\u0434\\u043C\\u0438\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})]});};export default UserDropdown;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","UserDropdown","userInfo","setUserInfo","isOpen","setIsOpen","fetchUserInfo","response","fetch","method","headers","localStorage","getItem","ok","Error","data","json","error","console","handleLogout","removeItem","window","location","href","className","onMouseEnter","onMouseLeave","children","name","role","onClick"],"sources":["C:/Users/DanKs/GolandProjects/flower-shop-backend/frontend/src/components/UserDropdown.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport './UserDropdown.css';\r\n\r\nconst UserDropdown: React.FC = () => {\r\n    const [userInfo, setUserInfo] = useState<{ name: string; role?: string } | null>(null);\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const fetchUserInfo = async () => {\r\n            try {\r\n                const response = await fetch('/api/userinfo', {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Ошибка при получении информации о пользователе');\r\n                }\r\n\r\n                const data = await response.json();\r\n                setUserInfo(data);\r\n            } catch (error) {\r\n                console.error('Ошибка:', error);\r\n            }\r\n        };\r\n\r\n        fetchUserInfo();\r\n    }, []);\r\n\r\n    const handleLogout = () => {\r\n        localStorage.removeItem('token');\r\n        window.location.href = '/';\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"user-dropdown\"\r\n            onMouseEnter={() => setIsOpen(true)}\r\n            onMouseLeave={() => setIsOpen(false)}\r\n        >\r\n            <span className=\"username\">{userInfo ? userInfo.name : 'Загрузка...'}</span>\r\n            {isOpen && (\r\n                <div className=\"dropdown-menu\">\r\n                    <a href=\"/profile\">Профиль</a>\r\n                    <a href=\"/orders\">Заказы</a>\r\n                    <a href=\"/favorites\">Избранное</a>\r\n                    {userInfo?.role === \"admin\" && <a href=\"/admin\">Админ-панель</a>}\r\n                    <button onClick={handleLogout}>Выйти</button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default UserDropdown;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,KAAM,CAAAC,YAAsB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGP,QAAQ,CAAyC,IAAI,CAAC,CACtF,KAAM,CAACQ,MAAM,CAAEC,SAAS,CAAC,CAAGT,QAAQ,CAAC,KAAK,CAAC,CAE3CD,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAW,aAAa,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,eAAe,CAAE,CAC1CC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACL,eAAe,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAE,CAC1D,cAAc,CAAE,kBACpB,CACJ,CAAC,CAAC,CAEF,GAAI,CAACL,QAAQ,CAACM,EAAE,CAAE,CACd,KAAM,IAAI,CAAAC,KAAK,CAAC,gDAAgD,CAAC,CACrE,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAR,QAAQ,CAACS,IAAI,CAAC,CAAC,CAClCb,WAAW,CAACY,IAAI,CAAC,CACrB,CAAE,MAAOE,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,SAAS,CAAEA,KAAK,CAAC,CACnC,CACJ,CAAC,CAEDX,aAAa,CAAC,CAAC,CACnB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAa,YAAY,CAAGA,CAAA,GAAM,CACvBR,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC9B,CAAC,CAED,mBACIvB,KAAA,QACIwB,SAAS,CAAC,eAAe,CACzBC,YAAY,CAAEA,CAAA,GAAMpB,SAAS,CAAC,IAAI,CAAE,CACpCqB,YAAY,CAAEA,CAAA,GAAMrB,SAAS,CAAC,KAAK,CAAE,CAAAsB,QAAA,eAErC7B,IAAA,SAAM0B,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAEzB,QAAQ,CAAGA,QAAQ,CAAC0B,IAAI,CAAG,aAAa,CAAO,CAAC,CAC3ExB,MAAM,eACHJ,KAAA,QAAKwB,SAAS,CAAC,eAAe,CAAAG,QAAA,eAC1B7B,IAAA,MAAGyB,IAAI,CAAC,UAAU,CAAAI,QAAA,CAAC,4CAAO,CAAG,CAAC,cAC9B7B,IAAA,MAAGyB,IAAI,CAAC,SAAS,CAAAI,QAAA,CAAC,sCAAM,CAAG,CAAC,cAC5B7B,IAAA,MAAGyB,IAAI,CAAC,YAAY,CAAAI,QAAA,CAAC,wDAAS,CAAG,CAAC,CACjC,CAAAzB,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAE2B,IAAI,IAAK,OAAO,eAAI/B,IAAA,MAAGyB,IAAI,CAAC,QAAQ,CAAAI,QAAA,CAAC,qEAAY,CAAG,CAAC,cAChE7B,IAAA,WAAQgC,OAAO,CAAEX,YAAa,CAAAQ,QAAA,CAAC,gCAAK,CAAQ,CAAC,EAC5C,CACR,EACA,CAAC,CAEd,CAAC,CAED,cAAe,CAAA1B,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}